<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>MeAI</title>
<link rel="icon" href="data:,">
<style>
  :root{
    --fg:#fff; --dim:#cfd8dc; --accent:#8e7cff; --accent2:#4db6ff;
    --glass:rgba(255,255,255,.08); --bd:rgba(255,255,255,.18);
  }
  html,body{height:100%}
  body{
    margin:0; color:var(--fg);
    font-family:"Noto Sans JP",system-ui,Segoe UI,Roboto,"Hiragino Kaku Gothic ProN","Yu Gothic",sans-serif;
    background:#000 url("public/space_background.png") center/cover fixed no-repeat;
  }
  .hidden{display:none!important;}
  .center{position:absolute; inset:0; display:flex; flex-direction:column; align-items:center; justify-content:center; gap:16px; padding:20px; text-align:center;}
  .row{display:flex; gap:10px; align-items:center; justify-content:center; flex-wrap:wrap;}
  .panel{ background:var(--glass); border:1px solid var(--bd); border-radius:18px; padding:16px 18px; max-width:980px; width:min(94vw,980px); }
  .btn{ display:inline-flex; align-items:center; justify-content:center; gap:.5em; border:none; border-radius:999px; padding:12px 22px; cursor:pointer; color:#fff; font-weight:700; background:linear-gradient(135deg,var(--accent2),var(--accent)); }
  .btn.secondary{ background:linear-gradient(135deg,#607d8b,#90a4ae);}
  .btn.ghost{ background:transparent; border:1px solid rgba(255,255,255,.4);}
  .btn:disabled{ opacity:.5; cursor:not-allowed; }
  img.char{ width:min(34vw,220px); height:auto; border-radius:18px; box-shadow:0 8px 24px rgba(0,0,0,.35); background:rgba(255,255,255,.06); }
  .spacer{height:10px;}
  #cover h1{font-size:40px; margin:0;}
  #cover p{color:var(--dim); margin:.2em 0 0 0;}

  /* ===== 名前入力デザイン改善 ===== */
  .inputRow{
    display:flex; gap:8px; flex-wrap:wrap; justify-content:center;
    max-width:520px; margin:0 auto;
  }
  input[type="text"]{
    flex:1 1 320px;
    padding:12px 14px;
    border-radius:12px;
    border:1px solid rgba(255,255,255,.35);
    background:rgba(255,255,255,.18);
    color:#122;
    outline:none;
    box-shadow:0 6px 16px rgba(0,0,0,.18) inset;
    backdrop-filter: blur(6px);
    -webkit-backdrop-filter: blur(6px);
    transition:border-color .15s, box-shadow .15s, background .15s;
  }
  input[type="text"]::placeholder{ color:rgba(17,34,34,.6); }
  input[type="text"]:focus{
    background:rgba(255,255,255,.26);
    border-color:#9fbfff;
    box-shadow:0 0 0 3px rgba(79,166,255,.25);
  }
  #saveNameBtn{ height:44px; padding:0 18px; }

  /* ===== GAME部分 ===== */
  #game{ display:none; text-align:left; }
  #layout{ display:grid; gap:16px; grid-template-columns:260px 1fr; }
  #charBox{ display:flex; flex-direction:column; align-items:center; gap:10px; }
  #stats{ display:flex; gap:8px; flex-wrap:wrap; justify-content:center; }
  .chip{ font-weight:700; padding:.35em .8em; border-radius:999px; background:rgba(255,255,255,.12); border:1px solid var(--bd); }
  #greet{ font-size:18px; }
  #suggest{ font-size:18px; line-height:1.6; }
  #log{max-height:220px; overflow:auto; font-size:13px; opacity:.95; }
  #log li{margin:.2em 0;}
  .title{font-weight:700; opacity:.9; margin-bottom:6px;}
</style>
</head>
<body>

<!-- ===== COVER ===== -->
<section id="cover" class="center" aria-label="cover">
  <div class="panel">
    <h1>MeAI</h1>
    <p>小さな“やってみる”をやさしく提案してくれる相棒。</p>

    <div class="spacer"></div>

    <!-- 名前入力：黒ベタ→ガラス調に変更 -->
    <div class="panel" style="background:rgba(255,255,255,.05);">
      <div class="inputRow">
        <input id="userNameInput" type="text" placeholder="あなたの名前" aria-label="あなたの名前">
        <button class="btn" id="saveNameBtn" type="button">名前を保存</button>
      </div>
      <small id="nameHint">※あとで変更できます</small>
    </div>

    <div class="spacer"></div>
    <img id="coverChar" class="char" src="public/char/ako2.png" alt="キャラ">
    <div class="spacer"></div>
    <div class="row">
      <button class="btn" id="startBtn" type="button">はじめる</button>
    </div>
  </div>
</section>

<!-- ===== GAME ===== -->
<section id="game" class="center" aria-label="game">
  <div class="panel">
    <div id="greet">こんにちは！</div>
    <div class="spacer"></div>

    <div id="layout">
      <div id="charBox">
        <img id="gameChar" class="char" src="public/char/ako2.png" alt="キャラ">
        <div id="charNameView" class="chip">キャラ名：<span id="charNick">（未設定）</span></div>
        <div id="stats">
          <div class="chip">♡ ハート <span id="heartNum">0</span></div>
          <div class="chip">🎯 今日の提案 <span id="todayCount">0</span>/3</div>
          <div class="chip">🏅 スタンプ <span id="stampNum">0</span></div>
        </div>
        <div class="row">
          <button class="btn" id="doneBtn" type="button">やったよ♡</button>
          <button class="btn ghost" id="backBtn" type="button">カバーへ</button>
        </div>
      </div>

      <div id="rightCol">
        <div id="suggestBox" class="panel" style="background:rgba(255,255,255,.05);">
          <div class="title">今日の提案</div>
          <div id="suggest">ボタンを押すと、いまのあなたに合いそうな小さな行動を出します。</div>
          <div class="spacer"></div>
          <div class="row">
            <button class="btn" id="nextSuggestBtn" type="button">提案を出す</button>
            <button class="btn secondary" id="anotherBtn" type="button">別の案</button>
            <button class="btn" id="clearSuggestBtn" type="button" disabled>クリア！</button>
          </div>
        </div>

        <div class="spacer"></div>
        <div class="panel" style="background:rgba(255,255,255,.05);">
          <div class="title">きろく</div>
          <ul id="log"></ul>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
const $=(s)=>document.querySelector(s);
const LS_NAME='MEAI_NAME';
const LS_HEART='MEAI_HEART';
const LS_STAMP='MEAI_STAMP';
let hearts=Number(localStorage.getItem(LS_HEART)||0);
let stamps=Number(localStorage.getItem(LS_STAMP)||0);
let suggestPicked=null;

// 名前保存
$('#saveNameBtn').addEventListener('click',()=>{
  const v=$('#userNameInput').value.trim();
  localStorage.setItem(LS_NAME,v);
  alert(v?`こんにちは、${v}さん！`:"名前を保存しました");
});
// スタート
$('#startBtn').addEventListener('click',()=>{
  $('#cover').classList.add('hidden');
  $('#game').style.display='flex';
  const name=localStorage.getItem(LS_NAME)||"";
  $('#greet').textContent=name?`${name}さん、こんにちは！今日もよろしくね。`:"こんにちは！";
  $('#heartNum').textContent=hearts;
  $('#stampNum').textContent=stamps;
});
// カバーへ戻る
$('#backBtn').addEventListener('click',()=>{
  $('#game').style.display='none';
  $('#cover').classList.remove('hidden');
});
// やったよ
$('#doneBtn').addEventListener('click',()=>{
  hearts++;
  localStorage.setItem(LS_HEART,hearts);
  $('#heartNum').textContent=hearts;
});
</script>
</body>
</html>
