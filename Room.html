<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>MeAI – お世話コーナー</title>
<link rel="icon" href="data:,">
<style>
  :root{ --fg:#fff; --glass:rgba(255,255,255,.07); --glass-border:rgba(255,255,255,.16); }
  html,body{height:100%}
  body{
    margin:0; color:var(--fg);
    font-family:"Noto Sans JP",system-ui,Segoe UI,Roboto,"Hiragino Kaku Gothic ProN","Yu Gothic",sans-serif;
    background:#000 url("public/space_background.png") center/cover fixed no-repeat;
  }
  .wrap{max-width:960px;margin:0 auto;padding:24px}
  .glass{background:var(--glass);border:1px solid var(--glass-border);border-radius:16px;backdrop-filter:blur(8px)}
  .pad{padding:16px}
  .grid{display:grid;grid-template-columns:280px 1fr;gap:20px}
  #charWrap{text-align:center}
  #charWrap img{width:240px;height:auto;animation:sway 5s ease-in-out infinite;transform-origin:50% 0%}
  @keyframes sway{0%{transform:rotate(0)}25%{transform:rotate(1.2deg) translateY(-1px)}50%{transform:rotate(0)}75%{transform:rotate(-1.2deg) translateY(-1px)}100%{transform:rotate(0)}}
  .btn{border:none;border-radius:999px;padding:10px 16px;cursor:pointer;color:#fff;background:rgba(255,255,255,.18)}
  .btn:hover{background:rgba(255,255,255,.28)}
  .tile{display:flex;align-items:center;justify-content:space-between;padding:16px;border-radius:14px;margin-bottom:12px}
  .note{opacity:.9;font-size:13px}
  @media (max-width:820px){.grid{grid-template-columns:1fr} #charWrap img{width:200px}}
</style>
</head>
<body>
<div class="wrap">
  <div class="pad" style="display:flex;justify-content:space-between;align-items:center">
    <h1 style="margin:0;font-size:22px">お世話コーナー</h1>
    <div style="display:flex;gap:8px"><a class="btn" href="index.html">← ホーム</a></div>
  </div>

  <div class="grid">
    <!-- 左：キャラ -->
    <div class="glass pad">
      <div id="charWrap">
        <img id="charImg" alt="char" src="public/char/blue/calm.png">
        <div id="hello" style="margin-top:8px;opacity:.95"></div>
      </div>
      <hr style="border:none;border-top:1px solid var(--glass-border);margin:14px 0">
      <div id="status">❤️ <span id="hearts">0</span> ／ 連続 <span id="streak">0</span>日 ／ 🎖️<span id="stamps">0</span></div>
      <div class="note" style="margin-top:8px">※各メニューは<strong>1日1回</strong>まで（成功で ❤️+1）</div>
    </div>

    <!-- 右：メニュー -->
    <div class="glass pad">
      <div class="tile glass">
        <div><div style="font-weight:700">ごはんをあげる</div><small>feed.html ／ 1日1回</small></div>
        <a class="btn" href="feed.html">ひらく</a>
      </div>
      <div class="tile glass">
        <div><div style="font-weight:700">おへやをおそうじ</div><small>clean.html ／ 1日1回</small></div>
        <a class="btn" href="clean.html">ひらく</a>
      </div>
      <div class="tile glass">
        <div><div style="font-weight:700">うんち片付け 💩</div><small>poop.html ／ 1日1回（成功で❤️+1）</small></div>
        <a class="btn" href="poop.html">ひらく</a>
      </div>
      <div class="tile glass">
        <div><div style="font-weight:700">輪投げゲーム</div><small>ring.html ／ 1日1回（クリアで❤️+1）</small></div>
        <a class="btn" href="ring.html">ひらく</a>
      </div>
    </div>
  </div>
</div>

<script>
const LS_STATE='MEAI_STATE_V3'; const COLORS=['blue','pink','green','purple']; const EMOTIONS=['calm','joy','sad','sleep'];
const today=()=>new Date().toISOString().slice(0,10);
function loadState(){ return JSON.parse(localStorage.getItem(LS_STATE)||'{"userName":"","charColor":"blue","hearts":0,"streakDays":0,"stamps":0,"lastActionDate":null,"stage":"S0","unlocked":{"skins":[],"bg":[],"lines":[]}}'); }
function setEmotion(st,emo='calm'){ const c=COLORS.includes(st.charColor)?st.charColor:'blue'; document.getElementById('charImg').src=`public/char/${c}/${EMOTIONS.includes(emo)?emo:'calm'}.png`; }
function hello(st){ const name=st.userName||'あなた'; const t=today(); const last=st.lastActionDate; if(!last) return `こんにちは、${name}さん。いっしょにお世話しよう。`; if(last===t) return `${name}さん、きょうも来てくれて嬉しい！`; return `${name}さん、おかえり！`; }
function render(){ const st=loadState(); document.getElementById('hearts').textContent=st.hearts; document.getElementById('streak').textContent=st.streakDays; document.getElementById('stamps').textContent=st.stamps; setEmotion(st,'calm'); document.getElementById('hello').textContent=hello(st); }
document.addEventListener('DOMContentLoaded',render);
</script>
</body>
</html>
